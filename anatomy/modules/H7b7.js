/**
 * id: H7b7
 * path: ./switch-better-line
 */

(function(require,module,exports) {
"use strict";var e=this&&this.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},t=this&&this.__classPrivateFieldSet||function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n};Object.defineProperty(exports,"__esModule",{value:!0}),exports.SwitchBetterLine=void 0;var n=5,i=8e3,r=6e4,a=1e4,o=5e3,s=0,c=function(){function c(d,m){var l=this;this.video=d,this.opts=m,u.set(this,!1),h.set(this,[]),f.set(this,0),p.set(this,0),w.set(this,[]),this.getNeedSwitchLine=function(){return e(l,u)},this.destroy=function(){e(l,w).forEach(function(e){return e()}),t(l,w,[])},v.set(this,function(v){var d=0;s=performance.now();var m=function(){e(l,u)?c.switchNum+=1:d=performance.now()},g=function(){if(!(s+a>performance.now()||0===d||e(l,p)+o>=performance.now())){var c={duration:performance.now()-d,waitingStartTime:d};e(l,h).push(c),t(l,h,e(l,h).filter(function(n){return n.waitingStartTime+r<performance.now()&&t(l,f,e(l,f)-n.duration),n.waitingStartTime+r>=performance.now()})),t(l,f,e(l,h).reduce(function(e,t){return e+t.duration},0)),(e(l,f)>i||e(l,h).length>=n)&&t(l,u,!0)}},E=function(){t(l,p,performance.now())};v.addEventListener("playing",g),v.addEventListener("seeking",E),v.addEventListener("waiting",m),e(l,w).push(function(){v.removeEventListener("seeking",E),v.removeEventListener("playing",g),v.removeEventListener("waiting",m)})}),c.switchNum+1!==this.opts.lineNum&&e(this,v).call(this,d)}var u,h,f,p,w,v;return u=new WeakMap,h=new WeakMap,f=new WeakMap,p=new WeakMap,w=new WeakMap,v=new WeakMap,c.switchNum=0,c.lastSwitchTime=0,c}();exports.SwitchBetterLine=c;
})()